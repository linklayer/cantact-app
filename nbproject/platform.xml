<?xml version="1.0" encoding="UTF-8"?>
<project name="platform" default="download" basedir="..">
<!-- REFERENCE autoupdate and bootstrap from https://platform.netbeans.org/tutorials/nbm-ant.html -->
	<property name="bootstrap.url"
          value="http://deadlock.netbeans.org/hudson/job/nbms-and-javadoc/lastStableBuild/artifact/nbbuild/netbeans/harness/tasks.jar"/>
    <property name="autoupdate.catalog.url"
          value="http://updates.netbeans.org/netbeans/updates/8.0/uc/final/distribution/catalog.xml.gz"/>
    <property name="nbmant.download"
          value="${basedir}/nbmant"/>
	<!--Define custom task-->
    <condition property="download.required">
        <and>
            <not>
                <available file="${harness.dir}/suite.xml"/>
            </not>
            <isset property="bootstrap.url"/>
            <isset property="autoupdate.catalog.url"/>
        </and>
    </condition>
	<echo>Current directory : ${user.dir}</echo>
	<echo>Harness directory : ${nbplatform.default.harness.dir}</echo>
	<echo>Platform directory : ${nbplatform.active.dir}/platform</echo>
    <target name="download" if="download.required">
        <mkdir dir="${nbmant.download}"/>
        <get src="${bootstrap.url}" dest="${nbmant.download}/tasks.jar" usetimestamp="true" verbose="true"/>
        <taskdef name="autoupdate" classname="org.netbeans.nbbuild.AutoUpdate" classpath="${nbmant.download}/tasks.jar"/>
        <autoupdate installdir="${nbmant.download}" updatecenter="${autoupdate.catalog.url}">
            <modules includes=".*" clusters="harness[0-9]*"/>
            <modules includes=".*" clusters="platform[0-9]*"/>
        </autoupdate>
    </target>
</project>
